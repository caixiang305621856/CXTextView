
desc 'CXLib é’ˆå¯¹ç§æœ‰åº“å¿«é€Ÿå‡çº§ç»´æŠ¤'
lane :CXLib do |options|

# æ‰“æ ‡ç­¾éœ€è¦å’Œpodspecçš„ç‰ˆæœ¬å¯¹åº”
tagName = options[:tag]
# è¢«ä¸Šä¼ çš„ç›®æ ‡podspecæ–‡ä»¶
targetName = options[:target]
# æœ¬æ¬¡æ›´æ–°çš„å†…å®¹
msgName = options[:msg]

# git pull
#  git_pull 
# ç¡®è®¤æ˜¯ master åˆ†æ”¯
#  ensure_git_branch

cocoapods(
clean: true,
podfile: "./Example/Podfile"
)

git_add(path: ".")

git_commit(path: ".", message: "#{msgName}")

push_to_git_remote

if git_tag_exists(tag: tagName)
    UI.message("å‘ç°tag:#{tagName} ä¹‹å‰æœ‰tag,åˆ é™¤åŸæ¥çš„æ ‡ç­¾ğŸš€")
    remove_tag(tag:tagName)
end

add_git_tag(
tag: tagName
)

push_git_tags

pod_lib_lint(allow_warnings: true,use_libraries:true,sources: ['https://github.com/CocoaPods/Specs.git'])

pod_push(path: "#{targetName}.podspec",allow_warnings: true,use_libraries:true)

end
